@using ForkYeah.Models.Default;

@model IEnumerable<RepositoryListItem>

@using (Bs.Div().AddCss("relative-wrapper").Begin())
{
    using (Bs.Div().AddCss("scroll-wrapper").Begin())
    {
        foreach(RepositoryListItem repo in Model)
        {
            using (Bs.Div().AddCss("repository").Begin())
            {
                using (Bs.Div().AddCss("repository-button").Begin())
                {
                    using (Bs.ButtonGroup().SetVertical().Begin())
                    {
                        // TODO: Add tooltips
                        @Bs.LinkButton(repo.StargazersIncrease.ToString(), repo.HtmlUrl).SetIcon(Icon.TriangleTop).SetState(ButtonState.Primary)
                        @Bs.LinkButton(Bs.Span().AddCss("octicon", "octicon-mark-github") + " " + repo.StargazersCount.ToString(), repo.HtmlUrl)
                    }
                }
                using (Bs.Div().AddCss("repository-description").Begin())
                {
                    using (Bs.Heading3().Begin())
                    {
                        // TODO: Link this to the repo partial
                        @Bs.Link("FluentBootstrap").AddCss("repository-link").AddAttribute("data-owner", repo.Owner).AddAttribute("data-name", repo.Name)
                        @Bs.Small(Bs.Icon(Icon.Comment).ToString() + " 4")
                    }
                                
                    // TODO: Link this to a filter for the language
                    @Bs.Paragraph(Bs.Badge(repo.Language).ToString() + " " + repo.Description)
                }
            }
            @Bs.Element("hr")
        }
    }
}

<script>
    $( ".repository-link" ).click(function() {
        var repositoryAction = "@(Url.JavaScriptReplaceableUrl(MVC.Default.Details()))";
        repositoryAction = repositoryAction.replace("{@(MVC.Default.DetailsParams.owner)}", $(this).data("owner"));
        repositoryAction = repositoryAction.replace("{@(MVC.Default.DetailsParams.name)}", $(this).data("name"));
        $("#content").load(repositoryAction);
    });
</script>